$.fn.scroller=function(a){var b=$.extend({scrollingX:"true",scrollingY:"true",offsetTop:0,offsetLeft:0},a);$(this).attr("data-init","");new EasyScroller($(this)[0],{scrollingX:b.scrollingX,scrollingY:b.scrollingY,offsetTop:b.offsetTop,offsetLeft:b.offsetLeft});return this};(function(a){var b=Date.now||function(){return+(new Date)};var c=60;var d=1e3;var e={};var f=1;if(!a.core){a.core={effect:{}}}else if(!core.effect){core.effect={}}core.effect.Animate={requestAnimationFrame:function(){var b=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame;var c=!!b;if(b&&!/requestAnimationFrame\(\)\s*\{\s*\[native code\]\s*\}/i.test(b.toString())){c=false}if(c){return function(a,c){b(a,c)}}var d=60;var e={};var f=0;var g=1;var h=null;var i=+(new Date);return function(a,b){var c=g++;e[c]=a;f++;if(h===null){h=setInterval(function(){var a=+(new Date);var b=e;e={};f=0;for(var c in b){if(b.hasOwnProperty(c)){b[c](a);i=a}}if(a-i>2500){clearInterval(h);h=null}},1e3/d)}return c}}(),stop:function(a){var b=e[a]!=null;if(b){e[a]=null}return b},isRunning:function(a){return e[a]!=null},start:function(a,g,h,i,j,k){var l=b();var m=l;var n=0;var o=0;var p=f++;if(!k){k=document.body}if(p%20===0){var q={};for(var r in e){q[r]=true}e=q}var s=function(f){var q=f!==true;var r=b();if(!e[p]||g&&!g(p)){e[p]=null;h&&h(c-o/((r-l)/d),p,false);return}if(q){var t=Math.round((r-m)/(d/c))-1;for(var u=0;u<Math.min(t,4);u++){s(true);o++}}if(i){n=(r-l)/i;if(n>1){n=1}}var v=j?j(n):n;if((a(v,r,q)===false||n===1)&&q){e[p]=null;h&&h(c-o/((r-l)/d),p,n===1||i==null)}else if(q){m=r;core.effect.Animate.requestAnimationFrame(s,k)}};e[p]=true;core.effect.Animate.requestAnimationFrame(s,k);return p}}})(this);var Scroller;(function(){Scroller=function(a,b){this.__callback=a;this.options={scrollingX:true,scrollingY:true,animating:true,animationDuration:250,bouncing:true,locking:true,paging:false,snapping:false,zooming:false,minZoom:.5,maxZoom:3};for(var c in b){this.options[c]=b[c]}};var a=function(a){return Math.pow(a-1,3)+1};var b=function(a){if((a/=.5)<1){return.5*Math.pow(a,3)}return.5*(Math.pow(a-2,3)+2)};var c={__isSingleTouch:false,__isTracking:false,__isGesturing:false,__isDragging:false,__isDecelerating:false,__isAnimating:false,__clientLeft:0,__clientTop:0,__clientWidth:0,__clientHeight:0,__contentWidth:0,__contentHeight:0,__snapWidth:100,__snapHeight:100,__refreshHeight:null,__refreshActive:false,__refreshActivate:null,__refreshDeactivate:null,__refreshStart:null,__zoomLevel:1,setLeftTopOffset:function(a,b){var c=this;c.__scrollLeft=a;c.__scrollTop=b},__maxScrollLeft:0,__maxScrollTop:0,__scheduledLeft:0,__scheduledTop:0,__scheduledZoom:0,__lastTouchLeft:null,__lastTouchTop:null,__lastTouchMove:null,__positions:null,__minDecelerationScrollLeft:null,__minDecelerationScrollTop:null,__maxDecelerationScrollLeft:null,__maxDecelerationScrollTop:null,__decelerationVelocityX:null,__decelerationVelocityY:null,setDimensions:function(a,b,c,d){var e=this;if(a){e.__clientWidth=a}if(b){e.__clientHeight=b}if(c){e.__contentWidth=c}if(d){e.__contentHeight=d}e.__computeScrollMax();e.scrollTo(e.__scrollLeft,e.__scrollTop,true)},setPosition:function(a,b){var c=this;c.__clientLeft=a||0;c.__clientTop=b||0},setSnapSize:function(a,b){var c=this;c.__snapWidth=a;c.__snapHeight=b},activatePullToRefresh:function(a,b,c,d){var e=this;e.__refreshHeight=a;e.__refreshActivate=b;e.__refreshDeactivate=c;e.__refreshStart=d},finishPullToRefresh:function(){var a=this;a.__refreshActive=false;if(a.__refreshDeactivate){a.__refreshDeactivate()}a.scrollTo(a.__scrollLeft,a.__scrollTop,true)},getValues:function(){var a=this;return{left:a.__scrollLeft,top:a.__scrollTop,zoom:a.__zoomLevel}},getScrollMax:function(){var a=this;return{left:a.__maxScrollLeft,top:a.__maxScrollTop}},zoomTo:function(a,b,c,d){var e=this;if(!e.options.zooming){throw new Error("Zooming is not enabled!")}if(e.__isDecelerating){core.effect.Animate.stop(e.__isDecelerating);e.__isDecelerating=false}var f=e.__zoomLevel;if(c==null){c=e.__clientWidth/2}if(d==null){d=e.__clientHeight/2}a=Math.max(Math.min(a,e.options.maxZoom),e.options.minZoom);e.__computeScrollMax(a);var g=(c+e.__scrollLeft)*a/f-c;var h=(d+e.__scrollTop)*a/f-d;if(g>e.__maxScrollLeft){g=e.__maxScrollLeft}else if(g<0){g=0}if(h>e.__maxScrollTop){h=e.__maxScrollTop}else if(h<0){h=0}e.__publish(g,h,a,b)},zoomBy:function(a,b,c,d){var e=this;e.zoomTo(e.__zoomLevel*a,b,c,d)},scrollTo:function(a,b,c,d){var e=this;if(e.__isDecelerating){core.effect.Animate.stop(e.__isDecelerating);e.__isDecelerating=false}if(d!=null&&d!==e.__zoomLevel){if(!e.options.zooming){throw new Error("Zooming is not enabled!")}a*=d;b*=d;e.__computeScrollMax(d)}else{d=e.__zoomLevel}if(!e.options.scrollingX){a=e.__scrollLeft}else{if(e.options.paging){a=Math.round(a/e.__clientWidth)*e.__clientWidth}else if(e.options.snapping){a=Math.round(a/e.__snapWidth)*e.__snapWidth}}if(!e.options.scrollingY){b=e.__scrollTop}else{if(e.options.paging){b=Math.round(b/e.__clientHeight)*e.__clientHeight}else if(e.options.snapping){b=Math.round(b/e.__snapHeight)*e.__snapHeight}}a=Math.max(Math.min(e.__maxScrollLeft,a),0);b=Math.max(Math.min(e.__maxScrollTop,b),0);if(a===e.__scrollLeft&&b===e.__scrollTop){c=false}e.__publish(a,b,d,c)},scrollBy:function(a,b,c){var d=this;var e=d.__isAnimating?d.__scheduledLeft:d.__scrollLeft;var f=d.__isAnimating?d.__scheduledTop:d.__scrollTop;d.scrollTo(e+(a||0),f+(b||0),c)},doMouseZoom:function(a,b,c,d){var e=this;var f=a>0?.97:1.03;return e.zoomTo(e.__zoomLevel*f,false,c-e.__clientLeft,d-e.__clientTop)},doTouchStart:function(a,b){if(a.length==null){throw new Error("Invalid touch list: "+a)}if(b instanceof Date){b=b.valueOf()}if(typeof b!=="number"){throw new Error("Invalid timestamp value: "+b)}var c=this;if(c.__isDecelerating){core.effect.Animate.stop(c.__isDecelerating);c.__isDecelerating=false}if(c.__isAnimating){core.effect.Animate.stop(c.__isAnimating);c.__isAnimating=false}var d,e;var f=a.length===1;if(f){d=a[0].pageX;e=a[0].pageY}else{d=Math.abs(a[0].pageX+a[1].pageX)/2;e=Math.abs(a[0].pageY+a[1].pageY)/2}c.__initialTouchLeft=d;c.__initialTouchTop=e;c.__zoomLevelStart=c.__zoomLevel;c.__lastTouchLeft=d;c.__lastTouchTop=e;c.__lastTouchMove=b;c.__lastScale=1;c.__enableScrollX=!f&&c.options.scrollingX;c.__enableScrollY=!f&&c.options.scrollingY;c.__isTracking=true;c.__isDragging=!f;c.__isSingleTouch=f;c.__positions=[]},doTouchMove:function(a,b,c){if(a.length==null){throw new Error("Invalid touch list: "+a)}if(b instanceof Date){b=b.valueOf()}if(typeof b!=="number"){throw new Error("Invalid timestamp value: "+b)}var d=this;if(!d.__isTracking){return}var e,f;if(a.length===2){e=Math.abs(a[0].pageX+a[1].pageX)/2;f=Math.abs(a[0].pageY+a[1].pageY)/2}else{e=a[0].pageX;f=a[0].pageY}var g=d.__positions;if(d.__isDragging){var h=e-d.__lastTouchLeft;var i=f-d.__lastTouchTop;var j=d.__scrollLeft;var k=d.__scrollTop;var l=d.__zoomLevel;if(c!=null&&d.options.zooming){var m=l;l=l/d.__lastScale*c;l=Math.max(Math.min(l,d.options.maxZoom),d.options.minZoom);if(m!==l){var n=e-d.__clientLeft;var o=f-d.__clientTop;j=(n+j)*l/m-n;k=(o+k)*l/m-o;d.__computeScrollMax(l)}}if(d.__enableScrollX){j-=h;var p=d.__maxScrollLeft;if(j>p||j<0){if(d.options.bouncing){j+=h/2}else if(j>p){j=p}else{j=0}}}if(d.__enableScrollY){k-=i;var q=d.__maxScrollTop;if(k>q||k<0){if(d.options.bouncing){k+=i/2;if(!d.__enableScrollX&&d.__refreshHeight!=null){if(!d.__refreshActive&&k<=-d.__refreshHeight){d.__refreshActive=true;if(d.__refreshActivate){d.__refreshActivate()}}else if(d.__refreshActive&&k>-d.__refreshHeight){d.__refreshActive=false;if(d.__refreshDeactivate){d.__refreshDeactivate()}}}}else if(k>q){k=q}else{k=0}}}if(g.length>60){g.splice(0,30)}g.push(j,k,b);d.__publish(j,k,l)}else{var r=d.options.locking?3:0;var s=5;var t=Math.abs(e-d.__initialTouchLeft);var u=Math.abs(f-d.__initialTouchTop);d.__enableScrollX=d.options.scrollingX&&t>=r;d.__enableScrollY=d.options.scrollingY&&u>=r;g.push(d.__scrollLeft,d.__scrollTop,b);d.__isDragging=(d.__enableScrollX||d.__enableScrollY)&&(t>=s||u>=s)}d.__lastTouchLeft=e;d.__lastTouchTop=f;d.__lastTouchMove=b;d.__lastScale=c},doTouchEnd:function(a){if(a instanceof Date){a=a.valueOf()}if(typeof a!=="number"){throw new Error("Invalid timestamp value: "+a)}var b=this;if(!b.__isTracking){return}b.__isTracking=false;if(b.__isDragging){b.__isDragging=false;if(b.__isSingleTouch&&b.options.animating&&a-b.__lastTouchMove<=100){var c=b.__positions;var d=c.length-1;var e=d;for(var f=d;f>0&&c[f]>b.__lastTouchMove-100;f-=3){e=f}if(e!==d){var g=c[d]-c[e];var h=b.__scrollLeft-c[e-2];var i=b.__scrollTop-c[e-1];b.__decelerationVelocityX=h/g*(1e3/60);b.__decelerationVelocityY=i/g*(1e3/60);var j=b.options.paging||b.options.snapping?4:1;if(Math.abs(b.__decelerationVelocityX)>j||Math.abs(b.__decelerationVelocityY)>j){if(!b.__refreshActive){b.__startDeceleration(a)}}}}}if(!b.__isDecelerating){if(b.__refreshActive&&b.__refreshStart){b.__publish(b.__scrollLeft,-b.__refreshHeight,b.__zoomLevel,true);if(b.__refreshStart){b.__refreshStart()}}else{b.scrollTo(b.__scrollLeft,b.__scrollTop,true,b.__zoomLevel);if(b.__refreshActive){b.__refreshActive=false;if(b.__refreshDeactivate){b.__refreshDeactivate()}}}}b.__positions.length=0},__publish:function(c,d,e,f){var g=this;var h=g.__isAnimating;if(h){core.effect.Animate.stop(h);g.__isAnimating=false}if(f&&g.options.animating){g.__scheduledLeft=c;g.__scheduledTop=d;g.__scheduledZoom=e;var i=g.__scrollLeft;var j=g.__scrollTop;var k=g.__zoomLevel;var l=c-i;var m=d-j;var n=e-k;var o=function(a,b,c){if(c){g.__scrollLeft=i+l*a;g.__scrollTop=j+m*a;g.__zoomLevel=k+n*a;if(g.__callback){g.__callback(g.__scrollLeft,g.__scrollTop,g.__zoomLevel)}}};var p=function(a){return g.__isAnimating===a};var q=function(a,b,c){if(b===g.__isAnimating){g.__isAnimating=false}if(g.options.zooming){g.__computeScrollMax()}};g.__isAnimating=core.effect.Animate.start(o,p,q,g.options.animationDuration,h?a:b)}else{g.__scheduledLeft=g.__scrollLeft=c;g.__scheduledTop=g.__scrollTop=d;g.__scheduledZoom=g.__zoomLevel=e;if(g.__callback){g.__callback(c,d,e)}if(g.options.zooming){g.__computeScrollMax()}}},__computeScrollMax:function(a){var b=this;if(a==null){a=b.__zoomLevel}b.__maxScrollLeft=Math.max(b.__contentWidth*a-b.__clientWidth,0);b.__maxScrollTop=Math.max(b.__contentHeight*a-b.__clientHeight,0)},__startDeceleration:function(a){var b=this;if(b.options.paging){var c=Math.max(Math.min(b.__scrollLeft,b.__maxScrollLeft),0);var d=Math.max(Math.min(b.__scrollTop,b.__maxScrollTop),0);var e=b.__clientWidth;var f=b.__clientHeight;b.__minDecelerationScrollLeft=Math.floor(c/e)*e;b.__minDecelerationScrollTop=Math.floor(d/f)*f;b.__maxDecelerationScrollLeft=Math.ceil(c/e)*e;b.__maxDecelerationScrollTop=Math.ceil(d/f)*f}else{b.__minDecelerationScrollLeft=0;b.__minDecelerationScrollTop=0;b.__maxDecelerationScrollLeft=b.__maxScrollLeft;b.__maxDecelerationScrollTop=b.__maxScrollTop}var g=function(a,c,d){b.__stepThroughDeceleration(d)};var h=b.options.snapping?4:.1;var i=function(){return Math.abs(b.__decelerationVelocityX)>=h||Math.abs(b.__decelerationVelocityY)>=h};var j=function(a,c,d){b.__isDecelerating=false;b.scrollTo(b.__scrollLeft,b.__scrollTop,b.options.snapping)};b.__isDecelerating=core.effect.Animate.start(g,i,j)},__stepThroughDeceleration:function(a){var b=this;var c=b.__scrollLeft+b.__decelerationVelocityX;var d=b.__scrollTop+b.__decelerationVelocityY;if(!b.options.bouncing){var e=Math.max(Math.min(b.__maxDecelerationScrollLeft,c),b.__minDecelerationScrollLeft);if(e!==c){c=e;b.__decelerationVelocityX=0}var f=Math.max(Math.min(b.__maxDecelerationScrollTop,d),b.__minDecelerationScrollTop);if(f!==d){d=f;b.__decelerationVelocityY=0}}if(a){b.__publish(c,d,b.__zoomLevel)}else{b.__scrollLeft=c;b.__scrollTop=d}if(!b.options.paging){var g=.95;b.__decelerationVelocityX*=g;b.__decelerationVelocityY*=g}if(b.options.bouncing){var h=0;var i=0;var j=.03;var k=.08;if(c<b.__minDecelerationScrollLeft){h=b.__minDecelerationScrollLeft-c}else if(c>b.__maxDecelerationScrollLeft){h=b.__maxDecelerationScrollLeft-c}if(d<b.__minDecelerationScrollTop){i=b.__minDecelerationScrollTop-d}else if(d>b.__maxDecelerationScrollTop){i=b.__maxDecelerationScrollTop-d}if(h!==0){if(h*b.__decelerationVelocityX<=0){b.__decelerationVelocityX+=h*j}else{b.__decelerationVelocityX=h*k}}if(i!==0){if(i*b.__decelerationVelocityY<=0){b.__decelerationVelocityY+=i*j}else{b.__decelerationVelocityY=i*k}}}}};for(var d in c){Scroller.prototype[d]=c[d]}})();var EasyScroller=function(a,b){this.content=a;this.container=a.parentNode;this.options=b||{};var c=this;this.scroller=new Scroller(function(a,b,d){c.render(a,b,d)},b);this.bindEvents();this.content.style[EasyScroller.vendorPrefix+"TransformOrigin"]="left top";this.reflow(b)};EasyScroller.prototype.render=function(){var a=document.documentElement.style;var b;if(window.opera&&Object.prototype.toString.call(opera)==="[object Opera]"){b="presto"}else if("MozAppearance"in a){b="gecko"}else if("WebkitAppearance"in a){b="webkit"}else if(typeof navigator.cpuClass==="string"){b="trident"}var c=EasyScroller.vendorPrefix={trident:"ms",gecko:"Moz",webkit:"Webkit",presto:"O"}[b];var d=document.createElement("div");var e;var f=c+"Perspective";var g=c+"Transform";if(d.style[f]!==e){return function(a,b,c){this.content.style[g]="translate3d("+ -a+"px,"+ -b+"px,0) scale("+c+")"}}else if(d.style[g]!==e){return function(a,b,c){this.content.style[g]="translate("+ -a+"px,"+ -b+"px) scale("+c+")"}}else{return function(a,b,c){this.content.style.marginLeft=a?-a/c+"px":"";this.content.style.marginTop=b?-b/c+"px":"";this.content.style.zoom=c||""}}}();EasyScroller.prototype.reflow=function(a){this.scroller.setLeftTopOffset(a.offsetLeft,a.offsetTop);this.scroller.setDimensions(this.container.clientWidth,this.container.clientHeight,this.content.offsetWidth,this.content.offsetHeight);var b=this.container.getBoundingClientRect();this.scroller.setPosition(b.left+this.container.clientLeft,b.top+this.container.clientTop)};EasyScroller.prototype.bindEvents=function(){var a=this;window.addEventListener("resize",function(){a.reflow()},false);if("ontouchstart"in window){this.container.addEventListener("touchstart",function(b){if(b.touches[0]&&b.touches[0].target&&b.touches[0].target.tagName.match(/input|textarea|select/i)){return}a.scroller.doTouchStart(b.touches,b.timeStamp);b.preventDefault()},false);document.addEventListener("touchmove",function(b){a.scroller.doTouchMove(b.touches,b.timeStamp,b.scale)},false);document.addEventListener("touchend",function(b){a.scroller.doTouchEnd(b.timeStamp)},false);document.addEventListener("touchcancel",function(b){a.scroller.doTouchEnd(b.timeStamp)},false)}else{var b=false;this.container.addEventListener("mousedown",function(c){if(c.target.tagName.match(/input|textarea|select/i)){return}a.scroller.doTouchStart([{pageX:c.pageX,pageY:c.pageY}],c.timeStamp);b=true;c.preventDefault()},false);document.addEventListener("mousemove",function(c){if(!b){return}a.scroller.doTouchMove([{pageX:c.pageX,pageY:c.pageY}],c.timeStamp);b=true},false);document.addEventListener("mouseup",function(c){if(!b){return}a.scroller.doTouchEnd(c.timeStamp);b=false},false);this.container.addEventListener("mousewheel",function(b){if(a.options.zooming){a.scroller.doMouseZoom(b.wheelDelta,b.timeStamp,b.pageX,b.pageY);b.preventDefault()}},false)}}